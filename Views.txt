--- view eelised -- ???????????? ????????????? (??????????? ???????)
-- 1. saab kasutada andmebaasi skeemi keerukuse lihtsustamiseks, mitte IT inimestele -- ??? ????????? ?????? ?? ??????? ?????? ???? ??????
-- 2. saab kasutada rakendamise mehhanismina rea ja veerutaseme turvalisusena -- ????????? ?????? ??????????, ????? ?????????? 

--Create Table--

create table EmployeeIndex
(
Id int primary key,
Name nvarchar(20),
Salary int,
Gender nvarchar(20),
DeptNameId int
)

insert into EmployeeIndex values(1, 'John', 5000, 'Male', 3)
insert into EmployeeIndex values(2, 'Mike', 3400, 'Male', 2)
insert into EmployeeIndex values(3, 'Pam', 6000, 'Female', 1)
insert into EmployeeIndex values(4, 'Todd', 4800, 'Male', 4)
insert into EmployeeIndex values(5, 'Sara', 3200, 'Female', 1)
insert into EmployeeIndex values(6, 'Ben', 4800, 'Male', 3)

--Create view--

create view vEmployeesByDepartmentIndex
as
select EmployeeIndex.Id, Name, Salary, Gender, DepartmentName
from EmployeeIndex
join Department
on EmployeeIndex.DeptNameId = Department.Id

--- view, mis tagastab ainult IT osakonna t??tajad -- ?????????? ?????? ?????????? IT 
create view vITDepartment_Employees
as 
select EmployeeIndex.Id, Name, Salary, Gender, DepartmentName
from EmployeeIndex
join Department
on EmployeeIndex.DeptNameId = Department.Id
where Department.DepartmentName = 'IT'

--Use view--
select * from vITDepartment_Employees
--Create View--
--- piirame palga n?gemist kolmandatel isikutel -- ???????????? ???????? ??????? 3 ?????
-- veerru turvalisus e kus j?etakse mingi veerg v?lja
create view vEmployeesDataExceptSalary
as
select EmployeeIndex.Id, Name, Gender, DepartmentName
from EmployeeIndex
join Department
on EmployeeIndex.DeptNameId = Department.Id
--Use view--
select * from vEmployeesDataExceptSalary

--Create view--
--- view, kus saab kasutada ainult koondandmete n?itamiseks -- ???, ??? ????????? ??????? ??????
-- view, mis tagastab summeeritud andmeid
create view vEmployeesCountByDepartment
as
select DepartmentName, COUNT(EmployeeIndex.Id) as TotalEmployees
from EmployeeIndex
join Department
on EmployeeIndex.DeptNameId = Department.Id
group by DepartmentName